import os
import requests
import colorama
from colorama import Fore, Back, Style
from lxml import html

colorama.init(autoreset=True)

def FileInputAvailable():
    user_url = input(Fore.GREEN + "Enter the URL: ")
    report = input(Fore.GREEN + "Enter the file name for the report: ")
    report = os.path.join("reports", report)  # Append the "reports" folder to the file name
    rep = open(report, "w")
    rep.close()
    page = requests.get(user_url, verify=False)
    tree = html.fromstring(page.content)
    inputs = tree.xpath('//input[@name]')
    file_upload_available = False  # Flag to track if file upload functionality is found

    for element in inputs:
        startPoint = int(str(element).find("'")) + 1
        stopPoint = int(str(element).find("'", startPoint))
        name_value = str(element)[startPoint:stopPoint]
        print(name_value)

        if "type='file'" in element:
            file_upload_available = True
            break

    if file_upload_available:
        print(Fore.GREEN + "[+] File Upload Function available")
        with open(report, "a") as rapor:
            rapor.write("[+] File Upload Function available\n")
    else:
        print(Fore.RED + "[-] File Upload Function not available")
        with open(report, "a") as rapor:
            rapor.write("[-] File Upload Function not available\n")

if __name__ == "__main__":
    FileInputAvailable()
